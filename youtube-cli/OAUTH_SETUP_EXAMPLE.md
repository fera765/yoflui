# ?? Exemplo Visual - Setup OAuth Qwen

## ?? Passo a Passo Completo com Screenshots

### 1?? Obter Credenciais no Alibaba Cloud

#### Acesse o Console

```
?? https://dashscope.console.aliyun.com
```

#### Crie OAuth Application

```
???????????????????????????????????????????????????
? Create OAuth Application                        ?
???????????????????????????????????????????????????
?                                                 ?
? Application Name:                               ?
? ???????????????????????????????????????????     ?
? ? YouTube Analyst CLI                     ?     ?
? ???????????????????????????????????????????     ?
?                                                 ?
? Redirect URI:                                   ?
? ???????????????????????????????????????????     ?
? ? http://localhost:3456/callback          ?     ?
? ???????????????????????????????????????????     ?
?                                                 ?
? Scopes:                                         ?
? ? dashscope:read                                ?
? ? dashscope:write                               ?
?                                                 ?
?         [ Cancel ]        [ Create ]            ?
???????????????????????????????????????????????????
```

#### Copie Credenciais

```
???????????????????????????????????????????????????
? OAuth Application Created                       ?
???????????????????????????????????????????????????
?                                                 ?
? Client ID:                                      ?
? ???????????????????????????????????????????     ?
? ? abc123def456ghi789                      ? ??  ?
? ???????????????????????????????????????????     ?
?                                                 ?
? Client Secret:                                  ?
? ???????????????????????????????????????????     ?
? ? xyz789abc456def123                      ? ??  ?
? ???????????????????????????????????????????     ?
?                                                 ?
? ??  Save your Client Secret now!                ?
?    You won't be able to see it again.          ?
?                                                 ?
?                     [ OK ]                      ?
???????????????????????????????????????????????????
```

---

### 2?? Configurar na CLI

#### Inicie a CLI

```bash
$ npm run start
```

```
????????????????????????????????????????????????????????????????????????????????
?                                                                              ?
?  ? AI YouTube Analyst                    gpt-4.1-nano-2025-04-14 ? 0 msgs   ?
?                                                                              ?
????????????????????????????????????????????????????????????????????????????????



                                        ?


                 Ask me anything about YouTube trends and insights



  /llm config ?  /exit quit ?  esc clear

????????????????????????????????????????????????????????????????????????????????
?                                                                              ?
?  ? Ask me anything about YouTube...                                          ?
?                                                                              ?
????????????????????????????????????????????????????????????????????????????????
```

#### Digite /llm

```
????????????????????????????????????????????????????????????????????????????????
?                                                                              ?
?  ? /llm                                                                      ?
?                                                                              ?
????????????????????????????????????????????????????????????????????????????????
```

#### Selecione OAuth Qwen

```
? LLM Configuration

Select authentication mode:

  ?? Custom (Manual endpoint + API key)
> ?? OAuth Qwen

Press Enter to confirm ? Esc to cancel
```

#### Insira Client ID

```
? LLM Configuration

Qwen Client ID
? abc123def456ghi789?

Get your credentials at: https://dashscope.console.aliyun.com

Press Enter to confirm ? Esc to cancel
```

#### Insira Client Secret

```
? LLM Configuration

Qwen Client Secret
? ************************?

Press Enter to confirm ? Esc to cancel
```

---

### 3?? Autoriza??o no Browser

#### Browser Abre Automaticamente

```
? LLM Configuration

? Authenticating with Qwen...
Please complete authorization in your browser
A new browser window should have opened
Waiting for callback...

Press Enter to confirm ? Esc to cancel
```

#### P?gina de Autoriza??o (Browser)

```
???????????????????????????????????????????????????????????????????
? ?? oauth.aliyun.com                                             ?
???????????????????????????????????????????????????????????????????
?                                                                 ?
?                      Alibaba Cloud                              ?
?                                                                 ?
?  YouTube Analyst CLI wants to access your account               ?
?                                                                 ?
?  This application will be able to:                              ?
?                                                                 ?
?  ? Read your DashScope resources                               ?
?  ? Write to your DashScope resources                           ?
?                                                                 ?
?  This will allow the app to:                                    ?
?  ? Access Qwen models                                           ?
?  ? Make API requests on your behalf                             ?
?  ? Use your daily quota (2000 requests/day)                     ?
?                                                                 ?
?                                                                 ?
?         [ Cancel ]              [ Authorize ]                   ?
?                                                                 ?
???????????????????????????????????????????????????????????????????
```

#### Ap?s Clicar em "Authorize"

```
???????????????????????????????????????????????????????????????????
? ?? localhost:3456                                               ?
???????????????????????????????????????????????????????????????????
?                                                                 ?
?                                                                 ?
?                                                                 ?
?                  ? Authorization Successful!                   ?
?                                                                 ?
?         You can close this window and return to the terminal.   ?
?                                                                 ?
?                                                                 ?
?                                                                 ?
???????????????????????????????????????????????????????????????????
```

---

### 4?? Confirma??o na CLI

#### Tokens Recebidos

```
? LLM Configuration

? Configuration Ready

Mode: 
?? OAuth Qwen

Endpoint: 
https://dashscope.aliyuncs.com/compatible-mode/v1

Model: 
qwen-max

? Authenticated with Qwen OAuth

> ? Save Configuration
  ?? Logout from Qwen
  ? Cancel

Press Enter to confirm ? Esc to cancel
```

#### Salvar

```
[Ap?s selecionar "Save Configuration"]

? Configuration saved!
? Tokens saved successfully

[Volta para chat]
```

---

### 5?? Usar Normalmente

#### Chat Funcionando

```
????????????????????????????????????????????????????????????????????????????????
?                                                                              ?
?  ? AI YouTube Analyst                                qwen-max ? 0 msgs       ?
?                                                                              ?
????????????????????????????????????????????????????????????????????????????????

? Pesquise sobre as dores de quem quer emagrecer

?????????????????????????????????????????
?                                       ?
?  ? YouTube Search                     ?
?                                       ?
?  Query: emagrecimento dores           ?
?                                       ?
?  7 videos ? 70 comments               ?
?                                       ?
?????????????????????????????????????????

Baseado nos 70 coment?rios analisados de 7 v?deos sobre emagrecimento:

**Principais Dores Identificadas:**

1. Falta de motiva??o e disciplina
   - Muitos comentam sobre desistir facilmente
   ...

[An?lise completa usando OAuth Qwen]
[2000 requests/dia dispon?veis]
[Tokens salvos, n?o precisa logar novamente]
```

---

### 6?? Pr?xima Vez (Autom?tico)

#### Inicia CLI

```bash
$ npm run start
```

```
[Carregando...]

?? Loaded tokens from .oauth-tokens.json
? Authenticated with Qwen OAuth
   Access token expires in: 719 minutes

[CLI abre normalmente]
[Pronto para usar!]
[N?o precisa fazer OAuth de novo]
```

#### Se Token Expirou

```
[Sistema detecta automaticamente]

?? Token expired, refreshing...
? Token refreshed successfully
   New expiration: 1440 minutes

[Continua funcionando normalmente]
[Usu?rio nem percebe]
```

---

### 7?? Logout (Opcional)

#### Fazer Logout

```
> /llm

? LLM Configuration

? Configuration Ready
[...]
? Authenticated with Qwen OAuth

> ?? Logout from Qwen

[Tokens removidos]
```

#### Resultado

```
???  Tokens cleared
? Logged out from Qwen OAuth

[Pr?xima vez precisa fazer OAuth novamente]
```

---

## ?? Estrutura de Arquivos Ap?s Setup

```
youtube-cli/
??? config.json                 # Configs gerais
??? .oauth-tokens.json          # ? Tokens OAuth (N?O COMMITAR!)
??? .gitignore                  # Protege .oauth-tokens.json
??? source/
    ??? oauth-manager.ts        # L?gica OAuth
    ??? components/
        ??? OAuthConfigScreen.tsx  # UI /llm
```

### Conte?do de .oauth-tokens.json

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkw...",
  "refreshToken": "def50200c5f4e8a9b2d3c1e0f9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e2f1a0b9...",
  "expiresAt": 1730403600000,
  "provider": "qwen"
}
```

---

## ? Checklist de Setup

- [ ] Criar conta Alibaba Cloud
- [ ] Ativar servi?o DashScope
- [ ] Criar OAuth Application
  - [ ] Nome: "YouTube Analyst CLI"
  - [ ] Redirect URI: `http://localhost:3456/callback`
  - [ ] Scopes: `dashscope:read`, `dashscope:write`
- [ ] Copiar Client ID
- [ ] Copiar Client Secret
- [ ] Rodar `npm run start`
- [ ] Digitar `/llm`
- [ ] Selecionar "OAuth Qwen"
- [ ] Inserir Client ID
- [ ] Inserir Client Secret
- [ ] Autorizar no browser
- [ ] Salvar configura??o
- [ ] ? Pronto para usar 2000 requests/dia!

---

## ?? Resultado Final

- ? OAuth configurado
- ? Tokens salvos localmente
- ? Auto-refresh ativado
- ? 2000 requests/dia dispon?veis
- ? Nunca mais precisa logar
- ? Browser abre automaticamente
- ? Totalmente integrado na CLI

**Sistema pronto para produ??o!** ??
